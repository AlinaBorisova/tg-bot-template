const TelegramApi = require('node-telegram-bot-api');
const token = '7240620668:AAF0Y7-11Hs358-AnSjv3TnjqmLdmFzsy_Q';
const bot = new TelegramApi(token, { polling: true });
const channelId = '-1002225246920';

const buttonsOfStart = {
  reply_markup: JSON.stringify({
    inline_keyboard: [
      [{text: '–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫–∞–Ω–∞–ª', url: "https://t.me/channelForCheckUsers", callback_data: 'subscribe'}],
      [{text: '–ó–∞–±—Ä–∞—Ç—å –ø–æ–¥–∞—Ä–∫–∏', callback_data: 'takeGifts'}],
    ]
  })
}


const start = () => {
  bot.on("polling_error", err => console.log(err.data.error.message));

  bot.on('message', async msg => {
    const text = msg.text;
    const chatId = msg.chat.id;

    if (text === '/start') {
      await bot.sendPhoto(chatId, 'img/bot-start.jpg');

      await bot.sendMessage(chatId, `ü§ò –î–∞–≤–∞–π—Ç–µ –∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è! 

–ú–µ–Ω—è –∑–æ–≤—É—Ç –ê–Ω–¥—Ä–µ–π:


–ó–¥–µ—Å—å –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ–ª–µ–∑–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º –æ—Ç –º–µ–Ω—è –∏ –º–æ–µ–π –∫–æ–º–∞–Ω–¥—ã. –ü—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–∏ –∏ —ç–∫—Å–ø–µ—Ä—Ç—ã –≤—ã—Å—Ç—Ä–æ—è—Ç –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –ø–æ—Ç–æ–∫ –ø—Ä–æ–≥—Ä–µ—Ç—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥–∏ –æ—Å–≤–æ—è—Ç –Ω–æ–≤—ã–µ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –ø–æ–ª—É—á–∞—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ. 


–£—Å–ª–æ–≤–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª https://t.me/channelForCheckUsers 
–í –Ω–µ–º —è –¥–µ–ª—é—Å—å –ª–∏—á–Ω—ã–º –æ–ø—ã—Ç–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞. 

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Å—è –∏ –∑–∞–±–∏—Ä–∞–π –¥–æ—Å—Ç—É–ø—ã üöÄ`, buttonsOfStart);
    }
  });

  bot.on('callback_query', async msg => {
    try {
      switch(msg.data) {
        case "takeGifts":
          const subscribe = await bot.getChatMember(channelId, msg.from.id);
          console.log(subscribe);
          if(subscribe.status == 'left' || subscribe.status == 'kicked') {
            await bot.sendMessage(msg.message.chat.id, `–ù–µ —É–≤–∏–¥–µ–ª–∏ –í–∞—à—É –ø–æ–¥–ø–∏—Å–∫—É
            
–£—Å–ª–æ–≤–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ ‚Äî –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª https://t.me/channelForCheckUsers
–í –Ω–µ–º —è –¥–µ–ª—é—Å—å –ª–∏—á–Ω—ã–º –æ–ø—ã—Ç–æ–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞.

–ü–æ–¥–ø–∏—Å—ã–≤–∞–π—Å—è –∏ –∑–∞–±–∏—Ä–∞–π –¥–æ—Å—Ç—É–ø—ã üöÄ`,buttonsOfStart, {
              parse_mode: 'HTML'
            })
          break;
          } else {
            await bot.sendMessage(msg.message.chat.id, `–û—Ç–ª–∏—á–Ω–æ! –£–≤–∏–¥–µ–ª–∏ –ø–æ–¥–ø–∏—Å–∫—É üòé

–û–±–µ—â–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø—ã –∫ –ø–æ–ª–µ–∑–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º –ø—Ä–∏–¥—É—Ç –≤ —Å–ª–µ–¥—É—é—â–µ–º —Å–æ–æ–±—â–µ–Ω–∏–∏.

–ê –ø–æ–∫–∞ —Ö–æ—á—É –≤–∞—Å –ø—Ä–∏—è—Ç–Ω–æ —É–¥–∏–≤–∏—Ç—å. –í —ç—Ç–æ–º –±–æ—Ç–µ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –≥–æ—Ä–∞–∑–¥–æ –±–æ–ª—å—à–µ, —á–µ–º –¥–æ—Å—Ç—É–ø –∫ –æ–Ω–ª–∞–π–Ω-–ø—Ä–∞–∫—Ç–∏–∫—É–º—É üî•

–ó–¥–µ—Å—å —Å–æ–±—Ä–∞–Ω–æ –±–æ–ª–µ–µ 30 –ø–æ–ª–µ–∑–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤, –¥–∞—é—â–∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–∞: –º—ã—à–ª–µ–Ω–∏–µ, —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, –≤–æ—Ä–æ–Ω–∫–∏, –æ—Ö–≤–∞—Ç—ã, —Ç—Ä–∞—Ñ–∏–∫, –ø—Ä–æ–¥–∞–∂–∏. –†–µ—à–µ–Ω–∏—è, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –≤ –±–æ—Ç–µ, –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 200 –∫–æ–º–ø–∞–Ω–∏—è—Ö –≤ –†–§, –ï–≤—Ä–æ–ø–µ –∏ –°–®–ê ü§ò

–ö–∞–∂–¥—É—é –Ω–µ–¥–µ–ª—é –≤—ã –±—É–¥–µ—Ç–µ –ø–æ–ª—É—á–∞—Ç—å –Ω–æ–≤—ã–µ –ø–æ–ª–µ–∑–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã. –ó–∞–∫—Ä–µ–ø–∏—Ç–µ –±–æ—Ç, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏—Ö üìå`, {
              parse_mode: 'HTML'
            });

            await bot.sendMessage(msg.message.chat.id, `–õ–æ–≤–∏ –¥–æ—Å—Ç—É–ø—ã –∫ –æ–±–µ—â–∞–Ω–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º, –∫–æ—Ç–æ—Ä—ã–µ —É—Å–∏–ª—è—Ç —Ç–≤–æ–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ –ø–æ–∑–≤–æ–ª—è—Ç –≤—ã–π—Ç–∏ –Ω–∞ –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å üëá

‚úÖ –º–æ—è —Å–µ—Ö–º–∞ ¬´–ö–∞–∫ –ø–µ—Ä–µ–π—Ç–∏ –æ—Ç —Ç–æ—á–µ—á–Ω—ã—Ö —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –∫ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ –∏ –≤—ã–π—Ç–∏ –Ω–∞ –æ–±–æ—Ä–æ—Ç 360 –º–ª–Ω ‚ÇΩ¬ª `, {
              parse_mode: 'HTML'
            });

            await bot.sendPhoto(msg.message.chat.id, 'img/gift-1.jpg');
          }
          break;
      }
    }
    catch(error) {
      console.log(error);
    }

  })

}

start();